# testutil Package Documentation

**Import Path:** `github.com/mrz1836/mage-x/pkg/mage/testutil`

Generated by `go doc -all github.com/mrz1836/mage-x/pkg/mage/testutil`

---

package testutil // import "github.com/mrz1836/mage-x/pkg/mage/testutil"

Package testutil provides testing utilities and helpers for mage operations.

FUNCTIONS

func NewMockRunner() (*MockRunner, *MockBuilder)
    NewMockRunner creates a new enhanced mock runner with builder


TYPES

type CommandMatcher struct{}
    CommandMatcher provides utilities for matching command arguments

func NewCommandMatcher() *CommandMatcher
    NewCommandMatcher creates a new CommandMatcher instance for testing

func (CommandMatcher) ContainsArg(arg string) func([]string) bool
    ContainsArg returns a matcher that checks if args contain a specific
    argument

func (CommandMatcher) ContainsFlag(flag string) func([]string) bool
    ContainsFlag returns a matcher that checks if args contain a flag

func (CommandMatcher) HasSubcommand(subcommand string) func([]string) bool
    HasSubcommand returns a matcher that checks if the first arg matches

type MockBuilder struct {
	// Has unexported fields.
}
    MockBuilder provides a fluent interface for setting up common mock scenarios

func (b *MockBuilder) Build() *MockRunner
    Build returns the configured mock runner

func (b *MockBuilder) ExpectAnyCommand(err error) *MockBuilder
    ExpectAnyCommand sets up a catch-all expectation for any command

func (b *MockBuilder) ExpectFailure(message string) *MockBuilder
    ExpectFailure sets up failing command execution expectations

func (b *MockBuilder) ExpectGitCommand(subcommand, output string, err error) *MockBuilder
    ExpectGitCommand sets up expectations for git commands

func (b *MockBuilder) ExpectGoCommand(subcommand string, err error) *MockBuilder
    ExpectGoCommand sets up expectations for go commands

func (b *MockBuilder) ExpectSuccess() *MockBuilder
    ExpectSuccess sets up successful command execution expectations

func (b *MockBuilder) ExpectVersion(version string) *MockBuilder
    ExpectVersion sets up standard version-related git commands

type MockRunner struct {
	mock.Mock
}
    MockRunner provides enhanced mocking capabilities for command execution

func (m *MockRunner) RunCmd(name string, args ...string) error
    RunCmd executes a command and returns an error

func (m *MockRunner) RunCmdOutput(name string, args ...string) (string, error)
    RunCmdOutput executes a command and returns output and error

type RunnerGetter func() interface{}
    RunnerGetter is a function type for getting command runners

type RunnerSetter func(runner interface{}) error
    RunnerSetter is a function type for setting command runners

type StandardMocks struct {
	// Has unexported fields.
}
    StandardMocks sets up common mock expectations for standard operations

func (sm *StandardMocks) ForAll() *StandardMocks
    ForAll sets up mocks for all common operations

func (sm *StandardMocks) ForBuild() *StandardMocks
    ForBuild sets up mocks for build operations

func (sm *StandardMocks) ForGit() *StandardMocks
    ForGit sets up mocks for git operations

func (sm *StandardMocks) ForLint() *StandardMocks
    ForLint sets up mocks for linting operations

func (sm *StandardMocks) ForTest() *StandardMocks
    ForTest sets up mocks for test operations

type TestEnvironment struct {
	TempDir        string
	OrigDir        string
	Runner         *MockRunner
	Builder        *MockBuilder
	CommandMatcher *CommandMatcher
	// Has unexported fields.
}
    TestEnvironment provides a clean test environment with temporary directories

func NewTestEnvironment(t TestingInterface) *TestEnvironment
    NewTestEnvironment creates a new isolated test environment

func (env *TestEnvironment) Cleanup()
    Cleanup restores the original environment

func (env *TestEnvironment) CreateFile(path, content string)
    CreateFile creates a file with the given content

func (env *TestEnvironment) CreateGoMod(moduleName string)
    CreateGoMod creates a go.mod file in the test environment

func (env *TestEnvironment) CreateMageConfig(config string)
    CreateMageConfig creates a .mage.yaml configuration file

func (env *TestEnvironment) CreateProjectStructure()
    CreateProjectStructure creates a basic project structure

func (env *TestEnvironment) FileExists(path string) bool
    FileExists checks if a file exists

func (env *TestEnvironment) ReadFile(path string) string
    ReadFile reads a file and returns its content

func (env *TestEnvironment) StandardMocks() *StandardMocks
    StandardMocks creates standard mock configurations

func (env *TestEnvironment) WithMockRunner(setter RunnerSetter, getter RunnerGetter, fn func() error) error
    WithMockRunner executes a function with the mock runner active The setter
    and getter functions should be passed from the calling package

type TestingInterface interface {
	TempDir() string
	Helper()
	Fatalf(format string, args ...interface{})
}
    TestingInterface covers common functionality of *testing.T and *testing.B
